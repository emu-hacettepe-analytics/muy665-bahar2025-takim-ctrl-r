---
title: "Çalışma 2"
---

[Veri Seti](/assets/veri_edited_en.csv)

Projemizde yaptığımız veri analizinin kodlarını aşağıda görebilirsiniz;


```{r}
# Kütüphaneler
suppressPackageStartupMessages(library(readr))
suppressPackageStartupMessages(library(ggplot2))
suppressPackageStartupMessages(library(dplyr))
suppressPackageStartupMessages(library(tidyr))  # pivot_longer fonksiyonu için

# Veriyi yükleme
egitim_veri <- read.csv("./calisma2-veriler/veri_edited_en.csv", header = TRUE, sep = ";", encoding = "UTF-8")
# bosanma_veri <- read.csv("./calisma2-veriler/bosanma_verisi.csv", header = TRUE, sep = ";", encoding = "UTF-8")

# İl listesini tanımlama
iller <- c("TR","Ankara", "İstanbul", "İzmir", "Bursa", "Antalya")

# For döngüsü
for (il in iller) {
  
  # Veriyi 2018-2023 yılları ile sınırlama
  egitim_veri_filtreli <- egitim_veri %>% filter(province_name == il)
  
  # Veriyi uzun formata dönüştürme (karşılaştırılabilir barlar için)
  egitim_veri_long <- egitim_veri_filtreli %>%
    select(year, illiterate_total, literate_without_diploma_total, primary_school_total, primary_education_total) %>%
    pivot_longer(cols = -year, names_to = "Egitim_Duzeyi", values_to = "Kisi_Sayisi")
  
  # Bar chart oluşturma
  print(ggplot(egitim_veri_long, aes(x = factor(year), y = Kisi_Sayisi, fill = Egitim_Duzeyi)) +
    geom_bar(stat = "identity", position = "dodge") +
    scale_y_continuous(labels = function(x) paste(x / 1e6, "M"), limits = c(0, ifelse(il == "TR", 15e6, 1e6))) +
    labs(title = ifelse(il == "TR", "2018-2023 Yılları Arası Turkiye Geneli Eğitim Duzeyleri", paste("2018-2023 Yılları Arası", il, "Egitim Duzeyleri")),
         x = "Yıllar", y = "Kisi Sayisi") +
    scale_fill_manual(values = c("illiterate_total" = "red", 
                                 "literate_without_diploma_total" = "orange", 
                                 "primary_school_total" = "green", 
                                 "primary_education_total" = "blue"),
                      labels = c("Okuma Yazma Bilmeyen", 
                                 "Okur Yazar Olup Okul Bitirmeyen", 
                                 "İlkokul Mezunları", 
                                 "İlköğretim Mezunları")) +
  theme_minimal())
}


```

